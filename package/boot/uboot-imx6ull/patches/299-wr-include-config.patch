Index: u-boot-2020.10/include/configs/wirelessroad_ecspi3.h
===================================================================
--- /dev/null
+++ u-boot-2020.10/include/configs/wirelessroad_ecspi3.h
@@ -0,0 +1,247 @@
+/*
+ * Copyright (C) 2020 WirelessRoad.
+ *
+ * Configuration settings for the i.MX6ULL  board.
+ *
+ */
+#ifndef __MX6ULLNANO_CONFIG_H
+#define __MX6ULLNANO_CONFIG_H
+
+
+#include <asm/arch/imx-regs.h>
+#include <linux/sizes.h>
+#include "mx6_common.h"
+#include <asm/mach-imx/gpio.h>
+
+/* #define CONFIG_DM_WARN */
+/* #define DEBUG */
+
+#ifdef CONFIG_SECURE_BOOT
+#ifndef CONFIG_CSF_SIZE
+#define CONFIG_CSF_SIZE 0x4000
+#endif
+#endif
+
+#define IOMUXC_SNVS_BASE_ADDR       (AIPS3_ARB_BASE_ADDR + 0x90000)
+#define PHYS_SDRAM_SIZE	SZ_512M
+
+/*#define CONFIG_ENV_VARS_UBOOT_RUNTIME_CONFIG */
+
+/* Size of malloc() pool */
+#define CONFIG_SYS_MALLOC_LEN		(16 * SZ_1M)
+
+#define CONFIG_MXC_GPIO 1
+
+#define CONFIG_MXC_UART
+#define CONFIG_MXC_UART_BASE		UART1_BASE
+
+
+/* MMC Configs */
+/* #ifdef CONFIG_FSL_USDHC */
+#define CONFIG_SYS_FSL_ESDHC_ADDR	USDHC1_BASE_ADDR
+/* #endif */
+
+/* NAND */
+#ifdef CONFIG_NAND_MXS
+# define CONFIG_SYS_MAX_NAND_DEVICE	1
+# define CONFIG_SYS_NAND_BASE		0x40000000
+# define CONFIG_SYS_NAND_5_ADDR_CYCLE
+# define CONFIG_SYS_NAND_ONFI_DETECTION
+# define CONFIG_SYS_NAND_U_BOOT_START	CONFIG_SYS_TEXT_BASE
+# define CONFIG_SYS_NAND_U_BOOT_OFFS	0x200000
+
+/* MTD device */
+# define CONFIG_MTD_DEVICE
+# define CONFIG_CMD_MTDPARTS
+# define CONFIG_MTD_PARTITIONS
+# define MTDIDS_DEFAULT			"nand0=gpmi-nand"
+# define MTDPARTS_DEFAULT		"mtdparts=gpmi-nand:16m(ffit_ro),60m(froot_ro),16m(ufit_ro),60m(uroot_ro),-(ushared_rw)"
+
+
+
+/*JFFS2*/
+/*# define CONFIG_CMD_JFFS2
+# define CONFIG_FS_JFFS2*/
+
+# define CONFIG_RBTREE
+# define CONFIG_LZO
+
+# define CONFIG_APBH_DMA 1
+# define CONFIG_APBH_DMA_BURST 1
+# define CONFIG_APBH_DMA_BURST8 1
+#endif
+
+#define CONFIG_SYS_FSL_USDHC_NUM	1
+
+#ifdef CONFIG_FSL_QSPI
+#define CONFIG_SF_DEFAULT_BUS		0
+#define CONFIG_SF_DEFAULT_CS		0
+#define CONFIG_SF_DEFAULT_SPEED	40000000
+#define CONFIG_SF_DEFAULT_MODE		SPI_MODE_0
+#define FSL_QSPI_FLASH_NUM		1
+#define FSL_QSPI_FLASH_SIZE		SZ_32M
+#endif
+
+#ifdef CONFIG_CMD_SF
+#define CONFIG_MXC_SPI
+#define CONFIG_SF_DEFAULT_BUS		2
+#define CONFIG_SF_DEFAULT_CS		0
+#define CONFIG_SF_DEFAULT_SPEED		20000000
+#define CONFIG_SF_DEFAULT_MODE		0x0
+#endif
+
+#define CONFIG_CMD_USB
+/* USB Configs */
+#ifdef CONFIG_CMD_USB
+#define CONFIG_USB_MUSB_PIO_ONLY
+/* #define CONFIG_USB_EHCI */
+/* #define CONFIG_USB_EHCI_MX6 */
+/* #define CONFIG_USB_HOST_ETHER
+#define CONFIG_USB_ETHER_ASIX
+#define CONFIG_USB_ETHER_RTL8152 */
+#define CONFIG_EHCI_HCD_INIT_AFTER_RESET
+#define CONFIG_MXC_USB_PORTSC  (PORT_PTS_UTMI | PORT_PTS_PTW)
+#define CONFIG_MXC_USB_FLAGS   0
+#define CONFIG_USB_MAX_CONTROLLER_COUNT 2
+#endif
+
+
+/* #define CONFIG_CMD_NET */
+#define CONFIG_FEC_MXC
+#define CONFIG_PHY_MICREL
+
+#define CONFIG_MII
+#define CONFIG_ETHPRIME			"FEC"
+
+
+#define CONFIG_FEC_ENET_DEV		0
+#define IMX_FEC_BASE			ENET_BASE_ADDR
+#define CONFIG_FEC_MXC_PHYADDR          0x0
+#define CONFIG_FEC_XCV_TYPE             RMII
+
+
+#define CONFIG_SYS_I2C
+#define CONFIG_CMD_I2C
+/* I2C configs */
+#ifdef CONFIG_CMD_I2C
+#define CONFIG_SYS_I2C_MXC
+#define CONFIG_SYS_I2C_MXC_I2C1		/* enable I2C bus 1 */
+#define CONFIG_SYS_I2C_MXC_I2C2		/* enable I2C bus 2 */
+#define CONFIG_SYS_I2C_SPEED		400000
+#endif
+
+
+#define CONFIG_SYS_MMC_IMG_LOAD_PART	1
+
+#define CONFIG_DRIVE_USB "usb "
+#define CONFIG_DRIVE_MMC "mmc "
+#define CONFIG_DRIVE_TYPES CONFIG_DRIVE_MMC // CONFIG_DRIVE_USB disable usb probe on boot
+#define CONFIG_UMSDEVS CONFIG_DRIVE_MMC CONFIG_DRIVE_USB
+
+#define CONFIG_EXTRA_ENV_SETTINGS \
+	"bootdevs=" CONFIG_DRIVE_TYPES "\0" \
+	"umsdevs=" CONFIG_UMSDEVS "\0" \
+	"usb_pgood_delay=2000\0" \
+	"console=ttymxc1\0" \
+	"clearenv=if sf probe || sf probe || sf probe 1 ; then " \
+		"sf erase 0xc0000 0x2000 && " \
+		"echo restored environment to factory default ; fi\0" \
+	"loadaddr=84000000\0" \
+	"fit_size=1000000\0" \
+	"autoload=0\0" \
+	"dtbname=wirelessroad_stream_wifi_imx6ull.dtb\0" \
+	"bootcmd=for dtype in ${bootdevs}" \
+		"; do " \
+			"if itest.s \"xusb\" == \"x${dtype}\" ; then " \
+				"usb start ;" \
+			"fi; " \
+			"for disk in 0 1 ; do ${dtype} dev ${disk} ;" \
+				"load " \
+					"${dtype} ${disk}:1 " \
+					"${loadaddr} " \
+					"/6x_bootscript" \
+					"&& source ${loadaddr} ; " \
+			"done ; " \
+		"done ; " \
+		"setenv bootargs \"\"; "\
+		"sf probe;"\
+		"sf read ${loadaddr} 0x100000 0x700000;"\
+		"bootm ${loadaddr};"\
+		"\0" \
+	"initrd_high=0xffffffff\0" \
+	"loadaddr=0x82000000\0" \
+	"fdt_addr=0x83000000\0" \
+	"fdt_high=0xffffffff\0" \
+	"bootfile=u-boot.nano6ull.imx\0" \
+	"upgradeu=for dtype in ${bootdevs}" \
+		"; do " \
+		"for disk in 0 1 ; do ${dtype} dev ${disk} ;" \
+			"load ${dtype} ${disk}:1 80008000 " \
+				"/6x_upgrade.ull " \
+				"&& source 80008000 ; " \
+		"done ; " \
+	"done\0" \
+	"do_tftp_flash_firmware=dhcp;" \
+	 		"tftp ${loadaddr} imxfw.bin;" \
+			"sf probe;" \
+			"sf update ${loadaddr} 0 ${filesize};" \
+			"reset\0" \
+	"do_tftp_flash_uboot=dhcp;" \
+	 		"tftp ${loadaddr} uboot-imx.bin;" \
+			"sf probe;" \
+			"sf update ${loadaddr} 0 ${filesize};" \
+			"reset\0"
+
+/* Miscellaneous configurable options */
+#define CONFIG_SYS_MEMTEST_START	0x80000000
+#define CONFIG_SYS_MEMTEST_END		0x88000000
+
+#define CONFIG_SYS_LOAD_ADDR		CONFIG_LOADADDR
+#define CONFIG_SYS_HZ			1000
+
+/*#define CONFIG_STACKSIZE		SZ_128K*/
+
+/* Physical Memory Map */
+#define CONFIG_NR_DRAM_BANKS		1
+#define PHYS_SDRAM			MMDC0_ARB_BASE_ADDR
+
+#define CONFIG_SYS_SDRAM_BASE		PHYS_SDRAM
+#define CONFIG_SYS_INIT_RAM_ADDR	IRAM_BASE_ADDR
+#define CONFIG_SYS_INIT_RAM_SIZE	IRAM_SIZE
+
+#define CONFIG_SYS_INIT_SP_OFFSET \
+	(CONFIG_SYS_INIT_RAM_SIZE - GENERATED_GBL_DATA_SIZE)
+#define CONFIG_SYS_INIT_SP_ADDR \
+	(CONFIG_SYS_INIT_RAM_ADDR + CONFIG_SYS_INIT_SP_OFFSET)
+
+/* Environment organization */
+/* replacing #define CONFIG_ENV_SIZE            (8 *1024) */
+#define CONFIG_ENV_SIZE			0x2000
+
+#if !defined(CONFIG_CMD_SF)
+#define CONFIG_ENV_IS_IN_MMC
+#else
+#define CONFIG_ENV_IS_IN_SPI_FLASH
+#endif
+
+#if defined(CONFIG_ENV_IS_IN_MMC)
+#define CONFIG_ENV_OFFSET		(6 * 64 * 1024)
+#define CONFIG_SYS_MMC_ENV_DEV		0
+#elif defined(CONFIG_ENV_IS_IN_SPI_FLASH)
+#define CONFIG_ENV_OFFSET		(768 * 1024)
+#define CONFIG_ENV_SECT_SIZE		(8 * 1024)
+#define CONFIG_ENV_SPI_BUS		CONFIG_SF_DEFAULT_BUS
+#define CONFIG_ENV_SPI_CS		CONFIG_SF_DEFAULT_CS
+#define CONFIG_ENV_SPI_MODE		CONFIG_SF_DEFAULT_MODE
+#define CONFIG_ENV_SPI_MAX_HZ		CONFIG_SF_DEFAULT_SPEED
+#endif
+
+/*#define CONFIG_CMD_BMODE*/
+
+#define CONFIG_IMX_THERMAL
+
+#define CONFIG_IOMUX_LPSR
+
+/* #define CONFIG_SOFT_SPI */
+
+#endif
